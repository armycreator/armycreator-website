{% extends 'SitiowebArmyCreatorBundle::layout.html.twig' %}

{% block title %}
    {{ "unit_stuff.new.title"|trans({"%unit%": unit.name}) }}
{% endblock %}

{% block content %}
    {% set breed = app.request.get("breed") %}
    {% set game = breed.game %}
    {% set params = {"game": game.code, "breed": breed.slug} %}

    <form action="{{ path("unitstuff_create", params) }}" method="post" {{ form_enctype(form) }} class="opaque">
        <div>
            {% for unitStuffForm in form %}
                {% if unitStuffForm.vars.id == 'armycreator_unitstuffmulti__token' %}
                    {{ form_row(unitStuffForm) }}
                {% else %}
                    <div>
                        <div class="left">
                            {% set label = unitStuffForm.vars.value.stuff.name %}
                            {{ form_widget(unitStuffForm.available) }}
                            {{ label }}
                        </div>
                        {{ form_row(unitStuffForm.visible) }}
                        {{ form_row(unitStuffForm.points) }}
                        {{ form_row(unitStuffForm.auto) }}
                    </div>
                {% endif %}
            {% endfor %}
        </div>

        {#
        <div class="txtright">
            {{ form_widget(form.create, {"attr": {"class": "acButton"}}) }}
            {{ form_widget(form.createAndAdd, {"attr": {"class": "acButton"}}) }}
        </div>
        #}

        {{ form_rest(form) }}
    </form>

        <ul class="record_actions">
    <li>
        <a href="{{ path("admin_breed_unit", params) }}#unit-{{ unit.slug }}">
            {{ "breed.back_to_breed"|trans }}
        </a>
    </li>
</ul>
{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <script type="text/javascript" charset="utf-8">
        var armycreator = {
            "breed": {
                "slug": "{{ unit.breed.slug|e('js') }}",
                "game": { "code": "{{ unit.breed.game.code|e('js') }}" }
            }
        };
    </script>

    {% if app.environment == 'dev' %}
        <!-- dev:unitstuff-edit.js -->
<script src="/tmp/js/unitstuff-edit.js/fuzzy-min_0.js"></script>
<script src="/tmp/js/unitstuff-edit.js/unitstuff-edit_1.js"></script>
<!-- endbuild -->
    {% else %}
        <!-- prod:unitstuff-edit.js --><!-- endbuild -->
    {% endif %}
{% endblock %}
